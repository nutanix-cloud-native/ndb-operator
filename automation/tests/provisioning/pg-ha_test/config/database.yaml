apiVersion: ndb.nutanix.com/v1alpha1
kind: Database
metadata:
  name: db-pg-ha
spec:
  ndbRef: ndb-pg
  databaseInstance:
    Name: db-pg-ha
    databaseNames:
      - database_one
      - database_two
      - database_three
    clusterId: <cluster-id>
    credentialSecret: db-secret-pg-ha
    size: 10
    timezone: "UTC"
    type: postgres
    isHighAvailability: true
    profiles: {}
    timeMachine:
      name: db-pg-ha_TM
      description: "TM provisioned by operator"
      sla : "DEFAULT_OOB_GOLD_SLA"
      dailySnapshotTime:   "12:34:56"  
      snapshotsPerDay:     4          
      logCatchUpFrequency: 90           
      weeklySnapshotDay:   "WEDNESDAY"  
      monthlySnapshotDay:  24          
      quarterlySnapshotMonth: "Jan"  
    additionalArguments: # Optional block, can specify additional arguments that are unique to database engines.
      listener_port: "5432"
      failover_mode: "Automatic"
      deploy_haproxy: "false"
    nodes: 
      - vmName: "test1"
        properties:
          node_type: database
          role: Primary
          failover_mode: Automatic
      - vmName: "test2"
        properties:
          node_type: database
          role: Secondary
          failover_mode: Automatic
      - vmName: "test3"
        properties:
          node_type: database
          role: Secondary
          failover_mode: Automatic